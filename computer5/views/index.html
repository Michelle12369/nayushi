<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>kinect</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js"></script>
</head>
<body>
	<canvas id="bodyCanvas" width="512" height="424"></canvas>
	<script>	
		var socket = io.connect();
		// socket.on('bodyFrame', interpretData);
		// function interpretData(bodyFrame) {
  //   		for(var i = 0;  i < bodyFrame.bodies.length; i++) {
	 //    		if(bodyFrame.bodies[i].tracked) {
	 //    			var user1RightHand=bodyFrame.bodies[i].joints[11];
	 //    			console.log(bodyFrame.bodies[i].joints[11].depthX);
	 //    		}
	 //    	}
		// }
		var canvas = document.querySelector('#bodyCanvas'); 
 		var ctx = canvas.getContext('2d'); 
 		ctx.strokeStyle='#BADA55';

 		var lastX=0;
  		var lastY=0;
  		var isDrawing=false;
  		function draw(e){
 			if (!isDrawing){return};
 			ctx.beginPath();
 			ctx.moveTo(lastX,lastY);
 			ctx.lineTo(e.offsetX,e.offsetY);
 			ctx.stroke();
 			lastX=e.offsetX;
 			lastY=e.offsetY;
 		}
 		canvas.addEventListener('mousemove',draw);
 		canvas.addEventListener('mousedown',function(e){
 			isDrawing=true;
 			lastX=e.offsetX;
 			lastY=e.offsetY;
 		});
 		canvas.addEventListener('mouseup',function(){
 			isDrawing=false;
 		});
 		canvas.addEventListener('mouseout',function(){
 			isDrawing=false;
 		});


 		var colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#00ffff', '#ff00ff']; 
 
 		// handstate circle size 
 		var HANDSIZE = 20; 
  
 		// closed hand state color 
 		var HANDCLOSEDCOLOR = "red"; 
  
 		// open hand state color 
 		var HANDOPENCOLOR = "green"; 
  
 		// lasso hand state color 
 		var HANDLASSOCOLOR = "blue"; 
  
 		function updateHandState(handState, jointPoint) { 
 			switch (handState) { 
 				case 3: 
 					drawHand(jointPoint, HANDCLOSEDCOLOR); 
 				break; 
  
 				case 2: 
 					// drawHand(jointPoint, HANDOPENCOLOR); 
 				break; 
  
 				case 4: 
 					drawHand(jointPoint, HANDLASSOCOLOR); 
 				break; 
 			} 
 		} 
  		

 		function drawHand(jointPoint, handColor) { 
 			// draw semi transparent hand cicles 
 			// ctx.globalAlpha = 0.75; 
 			// ctx.beginPath(); 
 			// ctx.fillStyle = handColor; 
 			// ctx.arc(jointPoint.depthX * 512, jointPoint.depthY * 424, HANDSIZE, 0, Math.PI * 2, true); 
 			// ctx.fill(); 
 			// ctx.closePath(); 
 			// ctx.globalAlpha = 1; 

 			// ctx.strokeStyle=handColor;
 			// ctx.beginPath();
 			// ctx.moveTo(lastX,lastY);
 			// ctx.lineTo(jointPoint.depthX * 512,jointPoint.depthY * 424);
 			// ctx.stroke();
 			// lastX=jointPoint.depthX * 512;
 			// lastY=jointPoint.depthY * 424;
 		} 
 		
 		
  
 		socket.on('bodyFrame', function(bodyFrame){ 
 			ctx.clearRect(0, 0, canvas.width, canvas.height); 
 			var index = 0; 
 			bodyFrame.bodies.forEach(function(body){ 
 				if(body.tracked) { 
 					for(var jointType in body.joints) { 
 						var joint = body.joints[jointType]; 
 						ctx.fillStyle = colors[index]; 
						ctx.fillRect(joint.depthX * 512, joint.depthY * 424, 10, 10); 
 					} 
 					//draw hand states 
 					// updateHandState(body.leftHandState, body.joints[7]); 
 					updateHandState(body.rightHandState, body.joints[11]); 
 					index++; 
 				} 
 			}); 
 		}); 

 		
	</script>
	
</body>
</html>